<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:doc="http://cssbox.sourceforge.net/docs"><head><title>CSSBox Manual</title><meta http-equiv="content-type" content="text/html; charset=utf-8" /><style type="text/css">
			@import "manual.css";
			</style></head><body><h1>CSSBox Manual</h1><p class="author">Radek Burget<br />
<a href="mailto:burgetr@fit.vutbr.cz">burgetr@fit.vutbr.cz</a>
</p><div class="toc"><h2>Table of Contents</h2><ul><li><a href="#intro">Introduction</a></li><li><a href="#basic">Basic usage</a><ul><li><a href="#basicLoading">Document Loading</a></li><li><a href="#basicLayout">Obtaining the Layout</a></li><li><a href="#basicDisplay">Displaying the document</a></li></ul></li><li><a href="#model">Rendered Document Model</a><ul><li><a href="#modelBox">Basic Box Properties</a></li><li><a href="#modelText">Text Boxes</a></li><li><a href="#modelElement">Element Boxes</a></li><li><a href="#modelInline">Inline Boxes</a></li><li><a href="#modelBlock">Block Boxes</a></li></ul></li></ul></div><div class="section" id="intro"><h2>Introduction</h2><p>CSSBox is an (X)HTML/CSS rendering engine written in pure Java. Its 
primary purpose is to provide a complete and further processable information 
about the rendered page contents and layout.</p><p>This manual gives a short overview of the CSSBox usage. It shows how to
render a document and it explains how the resulting page is represented and
how the basic information about the individual parts can be obtained.</p><p>More detailed information about the individual classes can be obtained
from the <a href="../api/index.html">API documentation</a>.</p><p>Any feedback to CSSBox and/or this manual is welcome via the
<a href="http://cssbox.sourceforge.net/">CSSBox website</a>.</p></div><div class="section" id="basic"><h2>Basic usage</h2><p>The input of the rendering engine is a document DOM tree. The engine is able to
automatically load the style sheets referenced in the document and it computes the
efficient style of each element. Afterwrads, the document layout is computed.</p><div class="subsection" id="basicLoading"><h3>Document Loading</h3><p>In the examples, the <a href="http://jtidy.sourceforge.net/">JTidy</a> HTML parser
is used. However, any other DOM parser can be used. For creating the DOM tree using
JTidy, following code can be used:</p><div class="code">
<br />Tidy tidy = new Tidy();
<br />tidy.setTrimEmptyElements(false);
<br />tidy.setInputEncoding("utf-8");
<br />Document doc = tidy.parseDOM(is, null);
</div><p>Note tha JTidy has many configuration options that can be found in the
documentation</p><p>For the initial DOM and style sheet processing, a
<a href="../api/org/fit/cssbox/css/DOMAnalyzer.html" class="api">DOMAnalyzer</a> object is used:</p><div class="code">
<br />DOMAnalyzer da = new DOMAnalyzer(doc, url);
<br />da.addStyleSheet(null, CSSNorm.stdStyleSheet()); <em>//use the standard style sheet</em>
<br />da.addStyleSheet(null, CSSNorm.userStyleSheet()); <em>//use the additional style sheet</em>
<br />da.getStyleSheets(); <em>//load the author style sheets</em>
<br />da.attributesToStyles(); <em>//convert the HTML presentation attributes to inline styles</em>
</div><p>The <code>addStyleSheet()</code> method is used to add a style sheet to the document
where the style sheet is a text string containing a CSS code. In our case we add two
built-in style sheets that represent the standard document style. The <code>CSSNorm.stdStyleSheet()</code>
method returns the CSS default style sheet and <code>CSSNorm.userStyleSheet()</code> contains some
internal CSSBox modifications of the standard.</p><p>The <code>getStyleSheets()</code> method loads and processes all the internal and external
style sheets referenced from the document. In case of external style sheets, CSSBox tries to obtain
the file from the corresponding URL, if accessible.</p><p>Finally, the <code>attributesToStyles()</code> converts some HTML presentation attributes to CSS
styles (e.g. the <code>&lt;font&gt;</code> tag attributes, table attributes and some more. If the HTML
attributes need not be interpreted, this method need not be called.</p><p>The resulting <code>DOMAnalyzer</code> object represents the document code together with the
associated style.</p></div><div class="subsection" id="basicLayout"><h3>Obtaining the Layout</h3><p>The whole layout engine is represented by a graphical
<a href="../api/org/fit/cssbox/layout/BrowserCanvas.html" class="api">BrowserCanvas</a> object. The layout is
computed automatically by creating an instance of this object. The constructor arguments are
the root DOM element (normally, it is the <code>&lt;body&gt;</code> element), the DOMAnalyzer used
for obtaining the element styles, the initial viewport dimensions and the document base URL used
for loading images and other referenced content.</p><div class="code">
<br />BrowserCanvas browser = new BrowserCanvas(da.getBody(), da, new java.awt.Dimension(1000, 600), url);
</div></div><p>The created <code>browser</code> object can be directly used for both displaying
the rendered document and for obtaining the created layout model.</p><div class="subsection" id="basicDisplay"><h3>Displaying the document</h3><p>The <a href="../api/org/fit/cssbox/layout/BrowserCanvas.html" class="api">BrowserCanvas</a> class is
directly derived from the Swing <code>javax.swing.JPanel</code> class. Therefore, it can
be directly used as a Swing user interface component. The size of the component is
automatically adjusted according to the resulting document layout. The basic document
displaying is shown in the <a href="../api/org/fit/cssbox/demo/SimpleBrowser.html" class="api">SimpleBrowser</a>
example.</p></div></div><div class="section" id="model"><h2>Rendered Document Model</h2><p>The resulting document layout is represented as a tree of <dfn>boxes</dfn>. Each box
creates a rectangular area in the resulting page and it corresponds to a particular
rendered HTML element. There may be multiple boxes corresponding to a single element;
e.g. a multi-line paragraph <code>&lt;p&gt;</code> is split to several line boxes. A box may be
either composed from child boxes or it may correspond to a particular part of the
document content, which may be a text string or replaced content (e.g. images).</p><p>Each box is represented by an object which extends the
<a href="../api/org/fit/cssbox/layout/Box.html" class="api">Box</a> abstract class. There exist
several box types that roughly correspond to the computed value of the CSS <code>display</code>
property for the corresponding element. Figure 1 shows the type hierarchy of boxes.</p><div class="figure"><img src="box_classes.png" alt="Box type hierarchy" /><p>Figure 1: Box type hierarchy</p></div><p>The root node of the box tree is always represented by a
<a href="../api/org/fit/cssbox/layout/Viewport.html" class="api">Viewport</a> object and it represents
the browser viewport. It has always a single child which is called a <dfn>root box</dfn>.
The root box corresponds to the root element of the HTML code passed to the
<a href="../api/org/fit/cssbox/layout/BrowserCanvas.html" class="api">BrowserCanvas</a> for rendering.
Usually, it is the <code>&lt;body&gt;</code> element.</p><p>The viewport and the root box are obtained using the
<a href="../api/org/fit/cssbox/layout/BrowserCanvas.html#getViewport()" class="api">getViewport()</a> and
<a href="../api/org/fit/cssbox/layout/BrowserCanvas.html#getRootBox()" class="api">getRootBox()</a> methods
of the BrowserCanvas.</p><div class="subsection" id="modelBox"><h3>Basic Box Properties</h3></div><div class="subsection" id="modelText"><h3>Text Boxes</h3></div><div class="subsection" id="modelElement"><h3>Element Boxes</h3></div><div class="subsection" id="modelInline"><h3>Inline Boxes</h3></div><div class="subsection" id="modelBlock"><h3>Block Boxes</h3></div></div></body></html>
